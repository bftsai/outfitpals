import{$ as U}from"./main-56f4b848.js";import{a as v,c as te}from"./ajaxMember-e4a1da22.js";const t=document.querySelector(".memberSpinner");U(document).ready(function(){U(".btn-group .btn").click(function(e){e.preventDefault(),t.classList.remove("d-none"),U(this).siblings().removeClass("active"),U(this).addClass("active"),E.render()})});const W="http://localhost:5173/outfitpals/pages/reserve.html",c=document.querySelector(".c-switch-btn-group"),n=document.querySelector(".reserve-content"),X=[...document.querySelectorAll(".backToReserve")],L=document.querySelector(".reserve-myDiscuss"),z=document.querySelector(".reserve-myDiscuss-Radio-Form"),T=document.getElementById("reserve-myDiscussCancel"),B=document.querySelector(".reserve-myDiscuss textarea"),J=document.querySelector(".reserveMyDiscussConfirmGroup"),q=document.querySelector(".reserveMyDiscussConfirmSubmit"),se=document.querySelector(".reserveMyDiscussConfirmCancel"),C=document.querySelector(".reserve-manageAppointments"),K=document.querySelector(".reserve-manageAppointments-Radio-Form"),P=document.getElementById("reserve-manageAppointmentsApprove"),F=document.getElementById("reserve-manageAppointmentsCancel"),R=document.querySelector(".reserve-manageAppointments textarea"),Q=document.querySelector(".reserveManageAppointmentsConfirmGroup"),k=document.querySelector(".reserveManageAppointmentsConfirmSubmit"),ne=document.querySelector(".reserveManageAppointmentsConfirmCancel"),i=document.querySelector(".pagination"),E={data:{},getPostArr(){return v.getPosts()},getCommentPostArr(e){return v.getPostsById(e)},getCommentObj(e){return v.getComment(e)},getPostCommentArr(e){return v.getPostComment(e)},getUserComment(e){return v.getUserComment(e)},getUserData(e){return v.getUserData(e)},async render(){const e=await this.getPostArr(),s=await this.getUserComment(te("outfitpalsId")),f=[...c.children[0].children[0].children[0].children].find(r=>{if(r.className.includes("active"))return r});f.textContent==="我的預約"?(n.innerHTML="",s.length!==0&&s.forEach(async(r,w)=>{const G=await this.getUserData(r.userId),u=new Date(r.postTime).toLocaleString("chinese",{hour12:!1}).split(" ")[0],h=document.createElement("li");h.className="row justify-content-between justify-content-lg-center align-items-center py-7 border border-grey1D",h.setAttribute("data-id",r.id),n.appendChild(h);const x=document.createElement("div");x.className="col-3 col-lg-2",h.appendChild(x);const S=document.createElement("img");S.className="object-fit-cover rounded-circle d-block mx-auto",S.src=G.image,S.alt="personal pic",x.appendChild(S);const m=document.createElement("div");m.className="col-5 col-sm-6 col-lg-8",h.appendChild(m);const p=document.createElement("div");p.className="card-body position-relative",m.appendChild(p);const y=document.createElement("p");y.className="card-title fs-5 fs-lg-3 fw-bold",y.textContent=G.name;let d=document.createElement("p");d.className="card-text multiline-ellipsis",d.textContent=r.body;const l=document.createElement("span");l.className="badge rounded-pill text-bg-greyE9 text-grey66 position-absolute fs-lg-8 top-10 start-100 start-sm-75 start-md-50 start-lg-30",l.textContent=r.state===!1?"預約中":l.textContent=r.state==="accept"?"預約成功":l.textContent=r.state==="reject"?"已拒絕":"已取消",p.appendChild(y),p.appendChild(d),p.appendChild(l);const b=document.createElement("div");b.className="col-4 col-sm-3 col-lg-2",h.appendChild(b),d=document.createElement("p"),d.className="card-text text-grey9F fs-8 text-end text-md-center",d.textContent=u,b.appendChild(d),t.classList.add("d-none"),[...document.querySelectorAll(".reserve-content li")][w].addEventListener("click",async A=>{t.classList.remove("d-none"),c.classList.add("opacity-0"),n.classList.add("opacity-0"),i.classList.add("opacity-0"),setTimeout(()=>{c.classList.add("d-none"),n.classList.add("d-none"),i.classList.add("d-none"),L.classList.remove("d-none"),setTimeout(()=>{L.classList.remove("opacity-0"),t.classList.add("d-none")},0)},400);const D=A.target.closest("li").getAttribute("data-id");L.setAttribute("data-id",D);const a=await E.getCommentObj(D),M=new Date(a.postTime).toLocaleString("chinese",{hour12:!1}).split(" ")[0],N=await E.getUserData(a.userId);a.state==="accept"||a.state==="reject"||a.state==="cancel"?(z.classList.add("d-none"),J.classList.add("d-none")):a.state===!1&&(z.classList.remove("d-none"),J.classList.remove("d-none"));const j=document.querySelector(".reserve-myDiscuss .image"),o=document.querySelector(".reserve-myDiscuss .name"),O=document.querySelector(".reserve-myDiscuss .date"),I=document.querySelector(".reserve-myDiscuss .reservationTime"),H=document.querySelector(".reserve-myDiscuss .location"),V=document.querySelector(".reserve-myDiscuss .state"),$=document.querySelector(".reserve-myDiscuss .commentBody");j.src=N.image,o.textContent=N.name,O.textContent=M,I.textContent=a.reservationTime,H.textContent=a.location,V.textContent=a.state===!1?"預約中":a.state==="accept"?"預約成功":a.state==="reject"?"已拒絕":"已取消",$.textContent=a.body})})):f.textContent==="預約管理"&&(n.innerHTML="",e.length!==0&&e.forEach(async r=>{const w=r.id;(await this.getPostCommentArr(w)).forEach(async(u,h)=>{const x=await this.getUserData(u.userId),S=new Date(u.postTime).toLocaleString("chinese",{hour12:!1}).split(" ")[0],m=document.createElement("li");m.className="row justify-content-between justify-content-lg-center align-items-center py-7 border border-grey1D",m.setAttribute("data-id",u.id),n.appendChild(m);const p=document.createElement("div");p.className="col-3 col-lg-2",m.appendChild(p);const y=document.createElement("img");y.className="object-fit-cover rounded-circle d-block mx-auto",y.src=x.image,y.alt="personal pic",p.appendChild(y);const d=document.createElement("div");d.className="col-5 col-sm-6 col-lg-8",m.appendChild(d);const l=document.createElement("div");l.className="card-body position-relative",d.appendChild(l);const b=document.createElement("p");b.className="card-title fs-5 fs-lg-3 fw-bold",b.textContent=x.name;let g=document.createElement("p");g.className="card-text multiline-ellipsis",g.textContent=u.body;const A=document.createElement("span");A.className="badge rounded-pill text-bg-greyE9 text-grey66 position-absolute fs-lg-8 top-10 start-100 start-sm-75 start-md-50 start-lg-30",A.textContent=u.state===!1?"預約中":A.textContent=u.state==="accept"?"預約成功":A.textContent=u.state==="reject"?"已拒絕":"已取消",l.appendChild(b),l.appendChild(g),l.appendChild(A);const D=document.createElement("div");D.className="col-4 col-sm-3 col-lg-2",m.appendChild(D),g=document.createElement("p"),g.className="card-text text-grey9F fs-8 text-end text-md-center",g.textContent=S,D.appendChild(g),t.classList.add("d-none"),[...document.querySelectorAll(".reserve-content li")].forEach(M=>{Number(M.getAttribute("data-id"))===w&&M.addEventListener("click",async N=>{t.classList.remove("d-none"),c.classList.add("opacity-0"),n.classList.add("opacity-0"),i.classList.add("opacity-0"),setTimeout(()=>{c.classList.add("d-none"),n.classList.add("d-none"),i.classList.add("d-none"),C.classList.remove("d-none"),setTimeout(()=>{C.classList.remove("opacity-0"),t.classList.add("d-none")},0)},400);const j=N.target.closest("li").getAttribute("data-id");C.setAttribute("data-id",j);const o=await E.getCommentObj(j),O=new Date(o.postTime).toLocaleString("chinese",{hour12:!1}).split(" ")[0],I=await E.getUserData(o.userId);o.state==="accept"||o.state==="reject"||o.state==="cancel"?(K.classList.add("d-none"),Q.classList.add("d-none")):o.state===!1&&(K.classList.remove("d-none"),Q.classList.remove("d-none"));const H=document.querySelector(".reserve-manageAppointments .image"),V=document.querySelector(".reserve-manageAppointments .name"),$=document.querySelector(".reserve-manageAppointments .date"),Y=document.querySelector(".reserve-manageAppointments .reservationTime"),Z=document.querySelector(".reserve-manageAppointments .location"),_=document.querySelector(".reserve-manageAppointments .state"),ee=document.querySelector(".reserve-manageAppointments .commentBody");H.src=I.image,V.textContent=I.name,$.textContent=O,Y.textContent=o.reservationTime,Z.textContent=o.location,_.textContent=o.state===!1?"預約中":o.state==="accept"?"預約成功":o.state==="reject"?"已拒絕":"已取消",ee.textContent=o.body})})})}))}};E.render();T.addEventListener("click",e=>{console.log("click"),T.checked===!0&&(q.disabled=!1)});B.addEventListener("keyup",e=>{B.value!==""?q.disabled=!1:q.disabled=!0});q.addEventListener("click",async e=>{e.preventDefault(),t.classList.remove("d-none");try{let s={};if(T.checked===!0){const f=L.getAttribute("data-id");s.state="cancel",await v.patchComment(f,s),t.classList.add("d-none"),location.href=W}}catch(s){console.log(s),t.classList.add("d-none")}});se.addEventListener("click",e=>{B.value="",T.checked=!1,q.disabled=!0,L.classList.add("opacity-0"),setTimeout(()=>{c.classList.remove("d-none"),n.classList.remove("d-none"),i.classList.remove("d-none"),L.classList.add("d-none"),setTimeout(()=>{c.classList.remove("opacity-0"),n.classList.remove("opacity-0"),i.classList.remove("opacity-0")},0)},400)});X[0].addEventListener("click",e=>{t.classList.remove("d-none"),B.value="",T.checked=!1,q.disabled=!0,L.classList.add("opacity-0"),setTimeout(()=>{c.classList.remove("d-none"),n.classList.remove("d-none"),i.classList.remove("d-none"),L.classList.add("d-none"),setTimeout(()=>{c.classList.remove("opacity-0"),n.classList.remove("opacity-0"),i.classList.remove("opacity-0"),t.classList.add("d-none")},0)},400)});document.querySelector(".reserve-manageAppointments .row:nth-child(3)").addEventListener("click",e=>{(P.checked===!0||F.checked===!0)&&(k.disabled=!1)});R.addEventListener("keyup",e=>{R.value!==""?k.disabled=!1:k.disabled=!0});k.addEventListener("click",async e=>{e.preventDefault();try{t.classList.remove("d-none");let s={};const f=C.getAttribute("data-id");P.checked===!0?(s.state="accept",await v.patchComment(f,s),t.classList.add("d-none")):F.checked===!0&&(s.state="reject",await v.patchComment(f,s),t.classList.add("d-none")),location.href=W}catch(s){console.log(s),t.classList.add("d-none")}});ne.addEventListener("click",e=>{t.classList.remove("d-none"),R.value="",P.checked=!1,F.checked=!1,k.disabled=!0,C.classList.add("opacity-0"),setTimeout(()=>{c.classList.remove("d-none"),n.classList.remove("d-none"),i.classList.remove("d-none"),C.classList.add("d-none"),setTimeout(()=>{c.classList.remove("opacity-0"),n.classList.remove("opacity-0"),i.classList.remove("opacity-0"),t.classList.add("d-none")},0)},400)});X[1].addEventListener("click",e=>{t.classList.remove("d-none"),R.value="",P.checked=!1,F.checked=!1,k.disabled=!0,C.classList.add("opacity-0"),setTimeout(()=>{c.classList.remove("d-none"),n.classList.remove("d-none"),i.classList.remove("d-none"),C.classList.add("d-none"),setTimeout(()=>{c.classList.remove("opacity-0"),n.classList.remove("opacity-0"),i.classList.remove("opacity-0"),t.classList.add("d-none")},0)},400)});
